import { ProgressTracker } from '@php-wasm/progress';
import { Semaphore } from '@php-wasm/util';
import type { SupportedPHPVersion, UniversalPHP } from '@php-wasm/universal';
import type { StepDefinition } from './steps';
import type { BlueprintDeclaration, BlueprintBundle, ExtraLibrary, StreamBundledFile, Blueprint } from './blueprint';
export type CompiledStep = (php: UniversalPHP) => Promise<void> | void;
export interface CompiledBlueprint {
    /** The requested versions of PHP and WordPress for the blueprint */
    versions: {
        php: SupportedPHPVersion;
        wp: string;
    };
    features: {
        intl: boolean;
        /** Should boot with support for network request via wp_safe_remote_get? */
        networking: boolean;
    };
    extraLibraries: ExtraLibrary[];
    /** The compiled steps for the blueprint */
    run: (playground: UniversalPHP) => Promise<void>;
}
export type OnStepCompleted = (output: any, step: StepDefinition) => any;
export interface CompileBlueprintOptions {
    /** Optional progress tracker to monitor progress */
    progress?: ProgressTracker;
    /** Optional semaphore to control access to a shared resource */
    semaphore?: Semaphore;
    /** Optional callback with step output */
    onStepCompleted?: OnStepCompleted;
    /**
     * Proxy URL to use for cross-origin requests.
     *
     * For example, if corsProxy is set to "https://cors.wordpress.net/proxy.php",
     * then the CORS requests to https://github.com/WordPress/gutenberg.git would actually
     * be made to https://cors.wordpress.net/proxy.php?https://github.com/WordPress/gutenberg.git.
     */
    corsProxy?: string;
    /**
     * A filesystem to use for the blueprint.
     */
    streamBundledFile?: StreamBundledFile;
}
export declare function compileBlueprint(input: BlueprintDeclaration | BlueprintBundle, options?: Omit<CompileBlueprintOptions, 'streamBundledFile'>): Promise<CompiledBlueprint>;
export declare function isBlueprintBundle(input: any): input is BlueprintBundle;
export declare function getBlueprintDeclaration(blueprint: Blueprint): Promise<BlueprintDeclaration>;
export declare function validateBlueprint(blueprintMaybe: object): {
    valid: true;
    errors?: undefined;
} | {
    valid: false;
    errors: import("ajv").ErrorObject<string, Record<string, any>, unknown>[] | undefined;
};
export declare function runBlueprintSteps(compiledBlueprint: CompiledBlueprint, playground: UniversalPHP): Promise<void>;
